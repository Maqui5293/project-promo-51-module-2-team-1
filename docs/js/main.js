const n=[document.querySelector("#title"),document.querySelector("#autor"),document.querySelector("#gender"),document.querySelector("#rate"),document.querySelector("#user")];function A(){var t,o,a,r,i;const e={title:((t=n[0])==null?void 0:t.value)||"",autor:((o=n[1])==null?void 0:o.value)||"",gender:((a=n[2])==null?void 0:a.value)||"",rate:((r=n[3])==null?void 0:r.value)||"",user:((i=n[4])==null?void 0:i.value)||""};localStorage.setItem("formData",JSON.stringify(e))}function T(){const e=localStorage.getItem("formData");if(e){const t=JSON.parse(e);n[0]&&(n[0].value=t.title||""),n[1]&&(n[1].value=t.autor||""),n[2]&&(n[2].value=t.gender||""),n[3]&&(n[3].value=t.rate||""),n[4]&&(n[4].value=t.user||"")}}n.forEach(e=>{e&&e.addEventListener("input",A)});window.addEventListener("DOMContentLoaded",T);const c=document.querySelector(".js_inputTitle"),u=document.querySelector(".js_inputAutor"),d=document.querySelector(".js_inputGender"),m=document.querySelector(".js_inputRate"),f=document.querySelector(".js_inputUserName"),h=document.querySelector(".js_buttonSubmit"),C=document.querySelector(".js_previewTitle"),x=document.querySelector(".js_previewAutor"),I=document.querySelector(".js_previewGender"),L=document.querySelector(".js_previewRate"),E=document.querySelector(".js_previewUserName");function D(e){let t="";e==1?t="⭐":e==2?t="⭐⭐":e==3?t="⭐⭐⭐":e==4?t="⭐⭐⭐⭐":(e==5,t="⭐⭐⭐⭐⭐"),L.textContent=t}function g(){C.textContent=c.value||"Título del libro",x.textContent=u.value||"Autor/a",I.textContent=d.value||"Género",E.textContent=f.value||"Nombre y apellidos",D(m.value)}c&&c.addEventListener("input",g);u&&u.addEventListener("input",g);d&&d.addEventListener("input",g);m&&m.addEventListener("input",g);f&&f.addEventListener("input",g);function R(){let e="";const t=document.querySelectorAll(".js-fondo-radio");for(const o of t)if(o.checked){e=o.value;break}return{field1:1,field2:c.value,field3:u.value,field4:d.value,field5:m.value,field6:f.value,field7:e,photo:window.photo}}function P(e){e.preventDefault();const t=R();fetch("https://dev.adalab.es/api/info/data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(o=>o.json()).then(o=>{if(console.log("Respuesta del servidor:",o),o.success){const a=o.infoID;console.log("UUID generado:",a),window.open(`./card.html?id=${a}`,"_blank")}else console.error("Error al crear la tarjeta:",o.error)})}h&&h.addEventListener("click",P);const j=document.querySelectorAll(".js_toggle");for(const e of j)e.addEventListener("click",t=>{const o=e.nextElementSibling,a=o.classList.contains("is-open");for(const r of j){r.nextElementSibling.classList.remove("is-open");const _=r.querySelector(".form__section-title");_&&(_.textContent=_.textContent.replace("⬆️","⬇️"))}if(!a){o.classList.add("is-open");const r=e.querySelector(".form__section-title");r&&(r.textContent=r.textContent.replace("⬇️","⬆️"))}});const b=document.querySelector(".js_cardPreview"),$=document.querySelectorAll(".js-fondo-radio");$.forEach(e=>{e.addEventListener("change",t=>{const o=t.target.value;b.classList.remove("romance","misterio","poesia","fantasia","cienciaficcion"),b.classList.add(o)})});const q=document.querySelector(".js_resetBtn");function U(){c.value="",u.value="",d.value="",m.value="",f.value="",C.textContent="Título del libro",x.textContent="Autor/a",I.textContent="Género",L.textContent="⭐⭐⭐⭐⭐",E.textContent="Nombre y apellidos",l.removeAttribute("style"),w.removeAttribute("style"),S.value=""}q&&q.addEventListener("click",U);window.photo="";const S=document.querySelector(".js__profile-upload-btn"),w=document.querySelector(".js__profile-preview"),l=document.querySelector(".js__profile-image"),p=new FileReader;function G(){w.style.backgroundImage=`url(${p.result})`,console.log("Imagen cargada:",p.result)}function N(){window.photo=p.result,l.style.backgroundImage=`url(${window.photo})`,l.style.backgroundSize="cover",l.style.backgroundPosition="center",l.style.backgroundRepeat="no-repeat",G()}function F(e){const t=e.currentTarget.files[0];t?(p.addEventListener("load",N,{once:!0}),p.readAsDataURL(t)):(l.style.backgroundImage="",w.style.backgroundImage="")}S&&S.addEventListener("change",F);const k=document.querySelector(".js_card");if(k){const t=new URLSearchParams(window.location.search).get("id");fetch(`https://dev.adalab.es/api/info/${t}`).then(o=>o.json()).then(o=>{o.success?O(o.data):console.error("Error al obtener la tarjeta:",o.error)}).catch(o=>{console.error("Error en la petición:",o)})}function O(e){k.innerHTML=`
  <article class="cardPreview ${e.field7}">
      <h2 class="card__title">${e.field2}</h2>               <!-- Título -->
      <p class="card__author">${e.field3}</p>                <!-- Autor -->
      <p class="card__gender">${e.field4}</p>                <!-- Género -->
      <p class="card__stars">${"⭐".repeat(e.field5)}</p>     <!-- Valoración -->
      <img class="card__image profile__image" src="${e.photo}" alt="Imagen del libro o recomendación"/> <!-- Imagen -->
      <p class="card__user">Recomendado por: ${e.field6}</p> <!-- Usuario -->
    </article>
  `}const s=document.querySelector(".js__profile-upload-btn"),v=document.querySelector(".js_imageError"),y=document.querySelector(".js__profile-preview");s&&s.addEventListener("change",e=>{const t=e.target.files[0];if(!t)return;const o=2*1024*1024,a=["image/jpeg","image/png","image/gif"];if(t.size>o){v.textContent="❌ Tu imagen es demasiado grande. Selecciona una con máximo 2MB.",s.value="",window.photo=null,y.style.backgroundImage="url('./images/Image_example.jpg')";return}if(!a.includes(t.type)){v.textContent="❌ Formato no válido. Usa JPG, PNG o GIF.",s.value="",window.photo=null,y.style.backgroundImage="url('./images/Image_example.jpg')";return}const r=new FileReader;r.onload=function(){const i=new Image;i.onload=()=>{v.textContent="",window.photo=r.result,y.style.backgroundImage=`url('${r.result}')`},i.onerror=()=>{v.textContent="❌ Tu imagen no se puede usar. El archivo está dañado.",s.value="",window.photo=null,y.style.backgroundImage="url('./images/Image_example.jpg')"},i.src=r.result},r.readAsDataURL(t)});
//# sourceMappingURL=main.js.map
